## UFO sighting ì— ê´€í•œ ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì›¹ì•± ë§Œë“¤ê¸°




ìš°ì„  íŒë‹¤ìŠ¤ì™€ ë„˜íŒŒì´ë¥¼ importí•´ì¤€ë‹¤ ê·¸ë¦¬ê³  ì €ì¥ë´ ë°ì´í„°ì¸ ufos.csvë¥¼ ê°€ì ¸ì˜¤ê³  ë³€ìˆ˜ì— ì €ì¥í•œë‹¤. 

```python
import pandas as pd
import numpy as np

ufos = pd.read_csv('../data/ufos.csv')
ufos.head()

```




<div>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>city</th>
      <th>state</th>
      <th>country</th>
      <th>shape</th>
      <th>duration (seconds)</th>
      <th>duration (hours/min)</th>
      <th>comments</th>
      <th>date posted</th>
      <th>latitude</th>
      <th>longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10/10/1949 20:30</td>
      <td>san marcos</td>
      <td>tx</td>
      <td>us</td>
      <td>cylinder</td>
      <td>2700.0</td>
      <td>45 minutes</td>
      <td>This event took place in early fall around 194...</td>
      <td>4/27/2004</td>
      <td>29.883056</td>
      <td>-97.941111</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10/10/1949 21:00</td>
      <td>lackland afb</td>
      <td>tx</td>
      <td>NaN</td>
      <td>light</td>
      <td>7200.0</td>
      <td>1-2 hrs</td>
      <td>1949 Lackland AFB&amp;#44 TX.  Lights racing acros...</td>
      <td>12/16/2005</td>
      <td>29.384210</td>
      <td>-98.581082</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10/10/1955 17:00</td>
      <td>chester (uk/england)</td>
      <td>NaN</td>
      <td>gb</td>
      <td>circle</td>
      <td>20.0</td>
      <td>20 seconds</td>
      <td>Green/Orange circular disc over Chester&amp;#44 En...</td>
      <td>1/21/2008</td>
      <td>53.200000</td>
      <td>-2.916667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10/10/1956 21:00</td>
      <td>edna</td>
      <td>tx</td>
      <td>us</td>
      <td>circle</td>
      <td>20.0</td>
      <td>1/2 hour</td>
      <td>My older brother and twin sister were leaving ...</td>
      <td>1/17/2004</td>
      <td>28.978333</td>
      <td>-96.645833</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10/10/1960 20:00</td>
      <td>kaneohe</td>
      <td>hi</td>
      <td>us</td>
      <td>light</td>
      <td>900.0</td>
      <td>15 minutes</td>
      <td>AS a Marine 1st Lt. flying an FJ4B fighter/att...</td>
      <td>1/22/2004</td>
      <td>21.418056</td>
      <td>-157.803611</td>
    </tr>
  </tbody>
</table>
</div>


ì•„ë˜ ì½”ë“œëŠ” ufos ë°ì´í„°ë¥¼ ìƒˆë¡œìš´ ì œëª©ì˜ ì‘ì€ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜í•œë‹¤.

```python

ufos = pd.DataFrame({'Seconds': ufos['duration (seconds)'], 'Country': ufos['country'],'Latitude': ufos['latitude'],'Longitude': ufos['longitude']})

ufos.Country.unique()

# 0 au, 1 ca, 2 de, 3 gb, 4 us
```




    array(['us', nan, 'gb', 'ca', 'au', 'de'], dtype=object)


ì•„ë˜ ì½”ë“œì—ì„œ ëª¨ë“  null ê°’ì„ ë“œëí•˜ê³  1-60ì´ˆ ì‚¬ì´ ëª©ê²©ë§Œ ê°€ì ¸ì™€ì„œ ì²˜ë¦¬í•  ë°ì´í„°ì˜ ìˆ˜ëŸ‰ì„
ì¤„ì¸ë‹¤.

```python
ufos.dropna(inplace=True)

ufos = ufos[(ufos['Seconds'] >= 1) & (ufos['Seconds'] <= 60)]

ufos.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 25863 entries, 2 to 80330
    Data columns (total 4 columns):
     #   Column     Non-Null Count  Dtype  
    ---  ------     --------------  -----  
     0   Seconds    25863 non-null  float64
     1   Country    25863 non-null  object 
     2   Latitude   25863 non-null  float64
     3   Longitude  25863 non-null  float64
    dtypes: float64(3), object(1)
    memory usage: 1010.3+ KB
    
Scikit-learnì˜ LabelEncoder ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ Importí•´ì„œ êµ­ê°€ì˜ í…ìŠ¤íŠ¸ ê°’ì„ ìˆ«ìë¡œ ë³€í™˜í•©ë‹ˆë‹¤.

```python
from sklearn.preprocessing import LabelEncoder

ufos['Country'] = LabelEncoder().fit_transform(ufos['Country'])

ufos.head()
```




<div>


<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Seconds</th>
      <th>Country</th>
      <th>Latitude</th>
      <th>Longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>20.0</td>
      <td>3</td>
      <td>53.200000</td>
      <td>-2.916667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>20.0</td>
      <td>4</td>
      <td>28.978333</td>
      <td>-96.645833</td>
    </tr>
    <tr>
      <th>14</th>
      <td>30.0</td>
      <td>4</td>
      <td>35.823889</td>
      <td>-80.253611</td>
    </tr>
    <tr>
      <th>23</th>
      <td>60.0</td>
      <td>4</td>
      <td>45.582778</td>
      <td>-122.352222</td>
    </tr>
    <tr>
      <th>24</th>
      <td>3.0</td>
      <td>3</td>
      <td>51.783333</td>
      <td>-0.783333</td>
    </tr>
  </tbody>
</table>
</div>

ì§€ê¸ˆë¶€í„° ë°ì´í„°ë¥¼ í›ˆë ¨í•˜ê³  í…ŒìŠ¤íŠ¸í•  ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ„ì–´ì„œ ëª¨ë¸ì„ í›ˆë ¨í•  ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.

1. X ë°±í„°ë¡œ í›ˆë ¨í•  3ê°€ì§€ featuresë¥¼ ì„ íƒí•˜ë©´, y ë°±í„°ëŠ” Countryë¡œ ë©ë‹ˆë‹¤. Seconds, Latitude ì™€ Longitudeë¥¼ ì…ë ¥í•˜ë©´ êµ­ê°€ idë¡œ ë°˜í™˜ë˜ê¸°ë¥¼ ì›í•©ë‹ˆë‹¤.


```python
from sklearn.model_selection import train_test_split

Selected_features = ['Seconds','Latitude','Longitude']

X = ufos[Selected_features]
y = ufos['Country']


X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)

```
2. logistic regressionì„ ì‚¬ìš©í•´ì„œ ëª¨ë¸ì„ í›ˆë ¨í•©ë‹ˆë‹¤:

```python
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score, classification_report 
from sklearn.linear_model import LogisticRegression
model = LogisticRegression()
model.fit(X_train, y_train)
predictions = model.predict(X_test)

print(classification_report(y_test, predictions))
print('Predicted labels: ', predictions)
print('Accuracy: ', accuracy_score(y_test, predictions))


```

    /Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:432: FutureWarning: Default solver will be changed to 'lbfgs' in 0.22. Specify a solver to silence this warning.
      FutureWarning)
    /Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/sklearn/linear_model/logistic.py:469: FutureWarning: Default multi_class will be changed to 'auto' in 0.22. Specify the multi_class option to silence this warning.
      "this warning.", FutureWarning)
                  precision    recall  f1-score   support
    
               0       1.00      1.00      1.00        41
               1       1.00      0.02      0.05       250
               2       0.00      0.00      0.00         8
               3       0.94      1.00      0.97       131
               4       0.95      1.00      0.97      4743
    
        accuracy                           0.95      5173
       macro avg       0.78      0.60      0.60      5173
    weighted avg       0.95      0.95      0.93      5173
    
    Predicted labels:  [4 4 4 ... 3 4 4]
    Accuracy:  0.9512855209742895
    /Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/sklearn/metrics/classification.py:1437: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples.
      'precision', 'predicted', average, warn_for)
    
Country ì™€ Latitude/Longitudeê°€ ìƒê´€ ê´€ê³„ìˆì–´ì„œ, ì •í™•ë„ (around 95%) ê°€ë‚˜ì™”ìŠµë‹ˆë‹¤

### ëª¨ë¸ì„ pickle í•  ì‹œê°„ì´ ë˜ì—ˆìŠµë‹ˆë‹¤ ì½”ë“œ ëª‡ ì¤„ë¡œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. pickled ë˜ë©´, pickled ëª¨ë¸ì„ ë¶ˆëŸ¬ì™€ì„œ ì´ˆ, ìœ„ë„ì™€ ê²½ë„ ê°’ì´ í¬í•¨ëœ ìƒ˜í”Œ ë°ì´í„° ë°°ì—´ì„ ëŒ€ìƒìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤

```python
import pickle
model_filename = 'ufo-model.pkl'
pickle.dump(model, open(model_filename,'wb'))

model = pickle.load(open('ufo-model.pkl','rb'))
print(model.predict([[50,44,-12]]))

```

    [3]




## Flask ì•± ë§Œë“¤ê¸°

ì´ì œë¶€í„° í”Œë¼ìŠ¤í¬ ì•±ì„ ë§Œë“­ë‹ˆë‹¤.

ìš°ì„  

1.Cë“œë¼ì´ë¸Œ ì•ˆì— soulution ì´ë¼ëŠ” í´ë”ë¥¼ ì›¹ì•± íŒŒì¼ë“¤ì„ í•œê³³ì— ëª¨ì•„ë‘ê¸° ìœ„í•´ì„œ ë§Œë“¤ì–´ ì¤¬ìŠµë‹ˆë‹¤.

2. ëª…ë ¹ì–´ í”„ë¡œí† ì½œì„ ì—´ê³  solution í´ë”ì— ë“¤ì–´ê°€ì„œ


     *WEP-APP1ì€ í™ˆí˜ì´ì§€ í´ëª…ì…ë‹ˆë‹¤
     py -3 -m venv WEP-APP1 
    
    
ë¥¼ ì ì–´ì¤ë‹ˆë‹¤ ê·¸ëŸ¬ë©´ WEP-APP1 ì´ë¼ëŠ” í´ë”ê°€ ìƒì„±ë˜ê³ 
í•˜ë‚˜ì˜ ê°€ìƒ í™˜ê²½ì¸ ì…ˆì…ë‹ˆë‹¤. ì´ ê°€ìƒ í™˜ê²½ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” activate ë¼ëŠ” íŒŒì¼ì„
ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤.

3. ëª…ë ¹ì–´ í”„ë¡œí† ì½œì— ë“¤ì–´ê°€ì„œ 


     cd WEP-APP1 
     cd Scripts
     activate


ë¡œ ì‹¤í–‰í•©ë‹ˆë‹¤.

4. ì´ ê°€ìƒ í™˜ê²½ì— í”Œë¼ìŠ¤í¬,ì‚¬ì´í‚· ëŸ° ë“±ì„ ì„¤ì¹˜í•´ì•¼í•©ë‹ˆë‹¤.

WEP-APP1 í´ë”ì—ì„œ ë§Œë“¤ ì²« íŒŒì¼ì€ requirements.txt íŒŒì¼ì…ë‹ˆë‹¤

    ## requirements.txt
    scikit-learn
    pandas
    numpy
    flask
    
 í„°ë¯¸ë„ì—ì„œ pip installì„ íƒ€ì´í•‘í•´ì„œ, requirements.txt ì— ë‚˜ì—´ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤:
 
     pip install -r requirements.txt
     
5. ì§€ê¸ˆë¶€í„°, ì•±ì„ ì™„ì„±í•˜ê¸° ìœ„í•´ì„œ 3ê°€ì§€ íŒŒì¼ì„ ë” ë§Œë“¤ ì¤€ë¹„ë¥¼ í–ˆìŠµë‹ˆë‹¤:

    1. ìµœìƒë‹¨ì— app.pyë¥¼ ë§Œë“­ë‹ˆë‹¤.
    3. templates ë””ë ‰í† ë¦¬ì— index.htmlì„ ë§Œë“­ë‹ˆë‹¤.
    4. static/css ë””ë ‰í† ë¦¬ì— styles.cssë¥¼ ë§Œë“­ë‹ˆë‹¤.     
    
6. í•´ë‹¹ íŒŒì¼ë“¤ì˜ ëª…ë ¹ì–´ëŠ”

### styles.css

    body {
	width: 100%;
	height: 100%;
	font-family: 'Helvetica';
	background: black;
	color: #fff;
	text-align: center;
	letter-spacing: 1.4px;
	font-size: 30px;
    }

    input {
	    min-width: 150px;
    }
     .grid {
	    width: 300px;
	    border: 1px solid #2d2d2d;
	    display: grid;
	    justify-content: center;
	    margin: 20px auto;
    }

    .box {
	   color: #fff;
	   background: #2d2d2d;
	   padding: 12px;
	   display: inline-block;
    }
### index.html 

    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="UTF-8">
      <title>ğŸ›¸ UFO Appearance Prediction! ğŸ‘½</title>
      <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}"> 
    </head>
    <body>
     <div class="grid">
      <div class="box">
      <p>According to the number of seconds, latitude and longitude, which country is likely to      have reported seeing a UFO?</p>

        <form action="{{ url_for('predict')}}" method="post">
    	    <input type="number" name="seconds" placeholder="Seconds" required="required" min="0"      max="60" />
          <input type="text" name="latitude" placeholder="Latitude" required="required" />
		      <input type="text" name="longitude" placeholder="Longitude" required="required" />
          <button type="submit" class="btn">Predict country where the UFO is seen</button>
        </form>  
       <p>{{ prediction_text }}</p>
     </div>
    </div>
   </body>
   </html>

### app.py

```python
import numpy as np
from flask import Flask, request, render_template
import pickle

app = Flask(__name__)

model = pickle.load(open("./ufo-model.pkl", "rb"))


@app.route("/")
def home():
    return render_template("index.html")


@app.route("/predict", methods=["POST"])
def predict():

    int_features = [int(x) for x in request.form.values()]
    final_features = [np.array(int_features)]
    prediction = model.predict(final_features)

    output = prediction[0]

    countries = ["Australia", "Canada", "Germany", "UK", "US"]

    return render_template(
        "index.html", prediction_text="Likely country: {}".format(countries[output])
    )


if __name__ == "__main__":
    app.run(debug=True)
```

7. ì´ì œ ì‹¤í–‰ì„ í•´ì•¼í•©ë‹ˆë‹¤ ì‹¤í–‰ ëª…ë ¹ì–´ëŠ”
    
     //--app ë‹¤ìŒì˜ appì´ py íŒŒì¼ì˜ ì´ë¦„ì…ë‹ˆë‹¤.
     flask --app app run

ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ë©´

![2](https://user-images.githubusercontent.com/112872986/236450752-c2164791-7f0d-43a8-9119-f47b1ff3eca3.png)

í•´ë‹¹ ì‚¬ì§„ì²˜ëŸ¼ í™”ë©´ì´ ë‚˜ì˜¤ëŠ”ë° ì—¬ê¸°

http://127.0.0.1:5000 ì´ê²ƒì„ ctrl+ í´ë¦­ ì„ í•´ì£¼ë©´ 

![1](https://user-images.githubusercontent.com/112872986/236450711-d57a0ab2-8448-4a43-8519-8f4843b52500.png)

ì´ë ‡ê²Œ êµ¬í˜„ëœ ì›¹ì„ ë³¼ìˆ˜ ìˆìŠµë‹ˆë‹¤

